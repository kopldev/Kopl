<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Projekter – KOPL</title>
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/project-grid.css">
</head>
<body>
  <div class="page-root">
    <header>
      <nav class="kopl-navbar">
        <a href="../index.html"><img class="kopl-nav-logo" src="https://kopl.dk/onewebmedia/hvidt%20visitkort_flad_sort%20tekst.png" alt="logo"></a>
        <div class="kopl-navbar-inner">
          <ul class="kopl-nav-links">
            <li><a class="kopl-nav-links-black" href="services.html">Ydelser</a></li>
            <li><a class="kopl-nav-links-black" href="contact.html">Kontakt</a></li>
            <li><a class="kopl-nav-links-black" href="project-grid.html">Projekter</a></li>
            <li><a class="kopl-nav-links-black" href="job.html">Job</a></li>
          </ul>
          <button class="kopl-nav-toggle" id="koplNavToggle" aria-label="Åbn menu">
            <span class="kopl-nav-toggle-bar"></span>
            <span class="kopl-nav-toggle-bar"></span>
            <span class="kopl-nav-toggle-bar"></span>
          </button>
        </div>
        <div class="kopl-mobile-menu" id="koplMobileMenu">
          <button class="kopl-mobile-close" id="koplMobileClose" aria-label="Luk menu">&times;</button>
          <ul>
            <li><a href="services.html">Ydelser</a></li>
            <li><a href="contact.html">Kontakt</a></li>
            <li><a href="contact.html">Projekter</a></li>
            <li><a href="job.html">Job</a></li>
          </ul>
        </div>
        <div class="kopl-mobile-overlay" id="koplMobileOverlay"></div>
      </nav>
    </header>
    <main class="main-content">
      <div class="headline-row">
        <div class="headline-content">
          <h1 class="page-title" style="margin-bottom:0.5rem;">Projekter</h1>
          <p class="page-intro">Et udvalg af projekter, der viser bredden i vores rådgivning og samarbejde med kommuner og bygherrer.</p>
        </div>
        <div class="filter-row">
          <label for="service-filter" class="filter-label">Filtrer efter ydelse</label>
          <select id="service-filter" class="filter-select">
            <option value="">Alle ydelser</option>
            <option value="Lokalplan">Lokalplan</option>
            <option value="Klagenævnspraksis">Klagenævnspraksis</option>
            <option value="Landsplanlægning">Landsplanlægning</option>
            <option value="Fingerplan">Fingerplan</option>
            <option value="Bebyggelsesplan">Bebyggelsesplan</option>
            <option value="Projektudvikling">Projektudvikling</option>
            <option value="Regnvandshåndtering">Regnvandshåndtering</option>
            <option value="Myndighedsrådgivning">Myndighedsrådgivning</option>
            <option value="Landzone">Landzone</option>
            <option value="Mulighedsnotat">Mulighedsnotat</option>
            <option value="Miljøvurdering">Miljøvurdering</option>
            <option value="Kommuneplantillæg">Kommuneplantillæg</option>
            <option value="Kystnærhedszonen">Kystnærhedszonen</option>
            <option value="Miljøkonsekvensvurdering">Miljøkonsekvensvurdering</option>
            <option value="Sommerhusloven">Sommerhusloven</option>
            <option value="Kvalitetssikring af Lokalplan">Kvalitetssikring af Lokalplan</option>
            <option value="Rådgivning og kvalitetssikring af lokalplan">Rådgivning og kvalitetssikring af lokalplan</option>
            <option value="Planrådgivning">Planrådgivning</option>
            <option value="Klagenævnspraksis">Klagenævnspraksis</option>
            <option value="Afgrænsningsnotat">Afgrænsningsnotat</option>
            <option value="Landskabsanalyse">Landskabsanalyse</option>
            <option value="Kommuneplan">Kommuneplan</option>
            <option value="Landskabsvurdering">Landskabsvurdering</option>
          </select>
        </div>
      </div>
      <div class="projects-grid" id="projects-grid"></div>
    </main>
  </div>
  <script>
    const navToggle = document.getElementById('koplNavToggle');
    const mobileMenu = document.getElementById('koplMobileMenu');
    const mobileClose = document.getElementById('koplMobileClose');
    const mobileOverlay = document.getElementById('koplMobileOverlay');
    navToggle.addEventListener('click', function() {
      mobileMenu.classList.add('open');
      mobileOverlay.classList.add('open');
      navToggle.classList.add('open');
    });
    mobileClose.addEventListener('click', function() {
      mobileMenu.classList.remove('open');
      mobileOverlay.classList.remove('open');
      navToggle.classList.remove('open');
    });
    mobileOverlay.addEventListener('click', function() {
      mobileMenu.classList.remove('open');
      mobileOverlay.classList.remove('open');
      navToggle.classList.remove('open');
    });
  </script>
  <script src="../js/ProjectData.js"></script>
  <script>
    const grid = document.getElementById('projects-grid');
    const serviceFilter = document.getElementById('service-filter');

    function renderProjects(filteredProjects) {
      grid.innerHTML = '';
      filteredProjects.forEach(project => {
        const a = document.createElement('a');
        a.className = 'project-card';
        a.href = `project.html?id=${project.id}`;
        a.innerHTML = `
          <div class="project-image-wrap">
            <img src="${project.heroImage}" alt="${project.title}" />
            <div class="project-overlay">
              <div class="project-title">${project.title}</div>
              <div class="project-meta">
                <div><span class="project-meta-label">ÅR:</span> <span class="project-meta-value">${project.year}</span></div>
                <div><span class="project-meta-label">LOKATION:</span> <span class="project-meta-value">${project.location}</span></div>
                <div><span class="project-meta-label">YDELSE:</span> <span class="project-meta-value">${project.services.join(', ')}</span></span></div>
              </div>
            </div>
          </div>
        `;
        grid.appendChild(a);
      });
      // Mobile: add click/tap to toggle overlay and require second tap to follow link
      if (window.innerWidth <= 767) {
        document.querySelectorAll('.project-card').forEach(card => {
          card.addEventListener('click', function(e) {
            if (!this.classList.contains('active')) {
              e.preventDefault();
              document.querySelectorAll('.project-card.active').forEach(c => c.classList.remove('active'));
              this.classList.add('active');
            } else {
              // Second tap: allow navigation
              // No preventDefault, link will be followed
            }
          });
        });
        // Hide overlay when clicking outside
        document.body.addEventListener('click', function(e) {
          if (!e.target.closest('.project-card')) {
            document.querySelectorAll('.project-card.active').forEach(c => c.classList.remove('active'));
          }
        });
      }
    }

    function filterProjectsByService(service) {
      if (!service) {
        renderProjects(projects);
        return;
      }
      const filtered = projects.filter(project => {
        // Split ydelser by comma, trim, and check if any match the selected service
        return project.services.map(s => s.trim()).includes(service);
      });
      renderProjects(filtered);
    }

    // Initial render
    renderProjects(projects);

    // Event listener for dropdown
    serviceFilter.addEventListener('change', function() {
      filterProjectsByService(this.value);
    });
  </script>
</body>
</html>
